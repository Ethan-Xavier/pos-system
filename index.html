<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Deli POS</title>
<style>
body { font-family: Arial, sans-serif; background: #f9f9f9; padding: 20px; }
.order-inputs { display: flex; flex-direction: column; max-width: 400px; gap: 6px; margin-bottom: 20px; background: #fff; padding: 10px; border-radius: 8px; }
input, select, button { padding: 6px; font-size: 14px; }
section { margin-bottom: 20px; }
h2 { margin-bottom: 6px; }
.order-box { background: #fff; padding: 8px; border-radius: 6px; margin-bottom: 6px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
.order-info { display: flex; flex-direction: column; gap: 2px; }
.order-actions button { margin-left: 4px; }
.modal { position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.5); display: none; justify-content: center; align-items: center; }
.modal-content { background:#fff; padding:20px; border-radius:8px; width:300px; }
</style>
</head>
<body>

<div class="order-inputs">
  <input id="description" placeholder="Description (group)" />
  <select id="typeSelect">
    <option value="" disabled selected>Select type</option>
    <option value="food">Food</option>
    <option value="drink">Drink</option>
  </select>
  <select id="itemSelect">
    <option value="" disabled selected>Select item</option>
  </select>
  <input id="quantity" type="number" min="1" value="1" />
  <button id="makeOrderBtn">Make Order</button>
</div>

<section>
  <h2>Placed Orders</h2>
  <div id="placedOrdersDiv"></div>
</section>

<section>
  <h2>Served Orders</h2>
  <div id="servedOrdersDiv"></div>
</section>

<section>
  <h2>Registered Orders</h2>
  <div id="registeredOrdersDiv"></div>
</section>

<section>
  <h2>Problem Orders</h2>
  <div id="problemOrdersDiv"></div>
</section>

<div id="problemModal" class="modal">
  <div class="modal-content">
    <h3>Select Problem</h3>
    <select id="problemSelect">
      <option value="" disabled selected>Select a problem</option>
      <option value="Order messed up">Order was messed up</option>
      <option value="Client canceled">Client canceled while prepared</option>
      <option value="Client didn't pay fully">Client didn't pay fully</option>
      <option value="Other">Other</option>
    </select>
    <button id="confirmProblemBtn">Confirm</button>
    <button id="cancelProblemBtn">Cancel</button>
  </div>
</div>

<script>
const typeSelect = document.getElementById('typeSelect');
const itemSelect = document.getElementById('itemSelect');
const makeOrderBtn = document.getElementById('makeOrderBtn');
const descriptionInput = document.getElementById('description');
const quantityInput = document.getElementById('quantity');

const placedOrdersDiv = document.getElementById('placedOrdersDiv');
const servedOrdersDiv = document.getElementById('servedOrdersDiv');
const registeredOrdersDiv = document.getElementById('registeredOrdersDiv');
const problemOrdersDiv = document.getElementById('problemOrdersDiv');

const problemModal = document.getElementById('problemModal');
const problemSelect = document.getElementById('problemSelect');
const confirmProblemBtn = document.getElementById('confirmProblemBtn');
const cancelProblemBtn = document.getElementById('cancelProblemBtn');

const menuItems = {
  food: { Pizza: 500, Pasta: 350, Burger: 400 },
  drink: { Soda: 50, Juice: 70, Water: 30 }
};

let placedOrders = [];
let servedOrders = [];
let registeredOrders = [];
let problemOrders = [];

let currentProblemOrder = null;

// Populate items based on type
typeSelect.addEventListener('change', () => {
  itemSelect.innerHTML = '<option value="" disabled selected>Select item</option>';
  const items = menuItems[typeSelect.value];
  for (const item in items) {
    const opt = document.createElement('option');
    opt.value = item;
    opt.textContent = `${item} - ${items[item]} mts`;
    itemSelect.appendChild(opt);
  }
});

// Log arrays for testing
function logArrays() {
  console.clear();
  console.log('Placed Orders:', placedOrders);
  console.log('Served Orders:', servedOrders);
  console.log('Registered Orders:', registeredOrders);
  console.log('Problem Orders:', problemOrders);
}

// Make order
makeOrderBtn.addEventListener('click', () => {
  const description = descriptionInput.value.trim();
  const type = typeSelect.value;
  const item = itemSelect.value;
  const quantity = parseInt(quantityInput.value);

  if(!description || !type || !item || !quantity) return alert('Fill all fields');

  const price = menuItems[type][item];
  const order = { description, type, item, quantity, price, total: price*quantity };

  placedOrders.push(order);
  renderOrders();
  logArrays();

  descriptionInput.value = '';
  quantityInput.value = 1;
  typeSelect.value = '';
  itemSelect.value = '';
});

// Render all orders
function renderOrders() {
  const render = (arr, div, actions) => {
    div.innerHTML = '';
    arr.forEach((order, idx) => {
      const box = document.createElement('div');
      box.className = 'order-box';
      box.innerHTML = `
        <div class="order-info">${order.description} - ${order.item} x${order.quantity} - ${order.total} mts</div>
        <div class="order-actions">${actions(idx, order)}</div>
      `;
      div.appendChild(box);
    });
  };

  render(placedOrders, placedOrdersDiv, idx => `
    <button onclick="cancelOrder(${idx}, 'placed')">Cancel</button>
    <button onclick="serveOrder(${idx})">Serve</button>
    <button onclick="problemOrder(${idx}, 'placed')">Problem</button>
  `);

  render(servedOrders, servedOrdersDiv, idx => `
    <button onclick="payOrder(${idx})">Pay</button>
    <button onclick="problemOrder(${idx}, 'served')">Problem</button>
  `);

  render(registeredOrders, registeredOrdersDiv, () => '');
  render(problemOrders, problemOrdersDiv, () => '');
}

// Actions
function cancelOrder(idx, arrayName) { if(arrayName==='placed') placedOrders.splice(idx,1); renderOrders(); logArrays(); }
function serveOrder(idx) { const order=placedOrders.splice(idx,1)[0]; servedOrders.push(order); renderOrders(); logArrays(); }
function payOrder(idx) { const order=servedOrders.splice(idx,1)[0]; registeredOrders.push(order); renderOrders(); logArrays(); }
function problemOrder(idx, arrayName) { currentProblemOrder={idx,arrayName}; problemModal.style.display='flex'; }

confirmProblemBtn.addEventListener('click', () => {
  if(!problemSelect.value) return alert('Select a problem');
  const {idx,arrayName} = currentProblemOrder;
  let order;
  if(arrayName==='placed') order = placedOrders.splice(idx,1)[0];
  if(arrayName==='served') order = servedOrders.splice(idx,1)[0];
  order.problemDesc = problemSelect.value;
  problemOrders.push(order);
  const zeroPriceOrder = {...order, total:0};
  registeredOrders.push(zeroPriceOrder);
  problemModal.style.display='none';
  renderOrders();
  logArrays();
  problemSelect.value='';
});

cancelProblemBtn.addEventListener('click', () => { problemModal.style.display='none'; problemSelect.value=''; });
</script>

</body>
</html>
