<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>POS System — Simplified</title>
<style>
body {
  font-family: Segoe UI, sans-serif;
  padding: 18px;
  display: flex;
  flex-direction: column;
  gap: 12px;
  background: #f4f4f4;
}

.order-group {
  background: #fff;
  padding: 12px;
  margin-bottom: 12px;
  border-radius: 10px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.1);
}

.order-line {
  display: flex;
  justify-content: space-between;
  padding: 4px 0;
  border-bottom: 1px solid #eee;
}

.order-line:last-child {
  border-bottom: none;
}

button {
  padding: 6px 10px;
  margin-right: 4px;
  border: none;
  border-radius: 6px;
  cursor: pointer;
}

.served-btn { background: #28a745; color: #fff; }
.cancel-btn { background: #dc3545; color: #fff; }
.pay-btn    { background: #007bff; color: #fff; }
.problem-btn{ background: #ffc107; color: #222; }

label, select, input { display:block; margin:6px 0; padding:6px; border-radius:6px; width:100%; }
textarea { width: 100%; border-radius: 6px; padding: 6px; }

#problemModal {
  display: none;
  position: fixed;
  top:0; left:0;
  width:100%; height:100%;
  background: rgba(0,0,0,0.5);
  justify-content: center;
  align-items: center;
}

#problemModal div {
  background: #fff;
  padding: 20px;
  border-radius: 12px;
  width: 300px;
  display: flex;
  flex-direction: column;
  gap: 10px;
}
</style>
</head>
<body>

<h2>POS System — Simplified</h2>

<!-- Order Form -->
<label>Description</label>
<input id="descInput" placeholder="e.g. Table 1 / John">

<label>Type</label>
<select id="typeSelect">
  <option value="" disabled selected>Select Type</option>
  <option value="food">Food</option>
  <option value="drink">Drink</option>
</select>

<label>Item</label>
<select id="itemSelect">
  <option value="" disabled selected>Select Item</option>
</select>

<label>Quantity</label>
<input type="number" id="qtyInput" value="1" min="1">

<button id="addBtn">Add Order</button>

<h3>Placed Orders</h3>
<div id="placedContainer"></div>

<h3>Served Orders</h3>
<div id="servedContainer"></div>

<h3>Paid Orders</h3>
<div id="paidContainer"></div>

<!-- Problem Modal -->
<div id="problemModal">
  <div>
    <h3>Report a Problem</h3>
    <textarea id="problemText" rows="5" placeholder="Describe the problem..."></textarea>
    <button id="saveProblemBtn" style="background:#28a745;color:#fff;">Save</button>
    <button id="closeProblemBtn" style="background:#dc3545;color:#fff;">Close</button>
  </div>
</div>

<script>
const typeSelect = document.getElementById('typeSelect');
const itemSelect = document.getElementById('itemSelect');
const descInput = document.getElementById('descInput');
const qtyInput = document.getElementById('qtyInput');
const addBtn = document.getElementById('addBtn');

const placedContainer = document.getElementById('placedContainer');
const servedContainer = document.getElementById('servedContainer');
const paidContainer = document.getElementById('paidContainer');

const problemModal = document.getElementById('problemModal');
const problemText = document.getElementById('problemText');
const saveProblemBtn = document.getElementById('saveProblemBtn');
const closeProblemBtn = document.getElementById('closeProblemBtn');

const menuItems = {
  food:['Pizza','Pasta','Burger','Salad','Soup'],
  drink:['Soda','Juice','Water','Coffee','Tea']
};

let placedOrders = [];
let servedOrders = [];
let paidOrders = [];

// Populate itemSelect based on type
typeSelect.addEventListener('change',()=> {
  itemSelect.innerHTML = '<option value="" disabled selected>Select Item</option>';
  menuItems[typeSelect.value].forEach(i=>{
    const opt=document.createElement('option');
    opt.value=i; opt.textContent=i;
    itemSelect.appendChild(opt);
  });
});

addBtn.addEventListener('click',()=>{
  const desc = descInput.value.trim() || 'Order';
  const item = itemSelect.value;
  const type = typeSelect.value;
  const qty = parseInt(qtyInput.value) || 1;
  const price = 100; // simplified price

  if(!item) { alert('Select item'); return; }

  placedOrders.push({description:desc, type, item, quantity:qty, price, time:new Date().toLocaleTimeString()});
  console.log('Placed Orders:', placedOrders);
  renderAll();
});

function renderGroup(container, ordersArray, status){
  container.innerHTML='';
  const groups = {};
  ordersArray.forEach(o=>{
    if(!groups[o.description]) groups[o.description]=[];
    groups[o.description].push(o);
  });

  Object.keys(groups).forEach(desc=>{
    const group = groups[desc];
    const div=document.createElement('div'); div.className='order-group';
    
    group.forEach(o=>{
      const line = document.createElement('div');
      line.className='order-line';
      line.innerHTML=`<span>${o.item} x${o.quantity}</span><span>${o.price*o.quantity} mts</span>`;
      div.appendChild(line);
    });

    // Buttons
    const btnDiv = document.createElement('div');
    if(status==='placed'){
      const cancelBtn = document.createElement('button'); cancelBtn.className='cancel-btn'; cancelBtn.textContent='Cancel';
      cancelBtn.onclick = ()=>{
        const idx = ordersArray.indexOf(group[0]);
        ordersArray.splice(idx, group.length);
        renderAll();
      };
      const servedBtn = document.createElement('button'); servedBtn.className='served-btn'; servedBtn.textContent='Served';
      servedBtn.onclick = ()=>{
        servedOrders.push(...group);
        ordersArray.splice(ordersArray.indexOf(group[0]), group.length);
        renderAll();
      };
      const problemBtn = document.createElement('button'); problemBtn.className='problem-btn'; problemBtn.textContent='Problem';
      problemBtn.onclick = ()=>{
        // Move to paidOrders with price 0
        paidOrders.push(...group.map(o=>({
          item: o.item,
          quantity: o.quantity,
          price: 0,
          time: o.time,
          description: o.description
        })));
        ordersArray.splice(ordersArray.indexOf(group[0]), group.length);
        renderAll();
        openProblemModal(desc);
      };
      btnDiv.append(cancelBtn, servedBtn, problemBtn);
    } else if(status==='served'){
      const payBtn = document.createElement('button'); payBtn.className='pay-btn'; payBtn.textContent='Pay';
      payBtn.onclick = ()=>{
        paidOrders.push(...group.map(o=>({item:o.item, quantity:o.quantity, price:o.price, time:o.time})));
        ordersArray.splice(ordersArray.indexOf(group[0]), group.length);
        console.log('Receipt:', paidOrders.slice(-group.length));
        renderAll();
      };
      const problemBtn = document.createElement('button'); problemBtn.className='problem-btn'; problemBtn.textContent='Problem';
      problemBtn.onclick = ()=>{
        paidOrders.push(...group.map(o=>({
          item: o.item,
          quantity: o.quantity,
          price: 0,
          time: o.time,
          description: o.description
        })));
        ordersArray.splice(ordersArray.indexOf(group[0]), group.length);
        renderAll();
        openProblemModal(desc);
      };
      btnDiv.append(payBtn, problemBtn);
    }
    div.appendChild(btnDiv);
    container.appendChild(div);
  });
}

function openProblemModal(desc){
  problemModal.style.display='flex';
  saveProblemBtn.onclick = ()=>{
    console.log(`Problem reported for ${desc}:`, problemText.value);
    problemText.value='';
    problemModal.style.display='none';
  };
  closeProblemBtn.onclick = ()=>{
    problemText.value='';
    problemModal.style.display='none';
  };
}

function renderAll(){
  renderGroup(placedContainer, placedOrders,'placed');
  renderGroup(servedContainer, servedOrders,'served');
  renderGroup(paidContainer, paidOrders,'paid');
}
</script>
</body>
</html>
